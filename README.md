Bean machine's rewrite. Eventual documentation
